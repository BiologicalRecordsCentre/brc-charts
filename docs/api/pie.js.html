<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: pie.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: pie.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/** @module pie */

import * as d3 from 'd3'
import { dataAccessors } from './dataAccess.js'

/** 
 * @param {Object} opts - Initialisation options.
 * @param {string} opts.selector - The CSS selector of the element which will be the parent of the SVG.
 * @param {string} opts.elid - The id for the dom object created.
 * @param {number} opts.width - The desired width of the chart.
 * @param {number} opts.height - The desired height of the chart.
 * @param {boolean} opts.expand - Indicates whether or not the chart will expand to fill parent element.
 * @param {Object} opts.accessFns - Sets an object whose properties are data access functions. The property
 * names are the 'keys'.
 * @param {string} opts.accessorKey - Sets the key of the selected data accessor function.
 * @param {string} opts.backgroundFill - Specifies the background colour of the chart.
 * @returns {module:pie~api} api - Returns an API for the map.
 */
export function pie({
  // Default options in here
  selector = 'body',
  elid = 'piechart',
  width = 500,
  height = 500,
  radius = 500,
  innerRadius = 0,
  //expand = false,
  accessFns = dataAccessors,
  fnKey = 'test',
  //backgroundFill = 'white',
} = {}) {

  const mainDiv = d3.select(`${selector}`)
    .append("div")
    .attr('id', elid)
    .style("position", "relative")
    .style("display", "inline")

  mainDiv.text('Hello World!')

  makeChart(accessFns[fnKey])


  function makeChart(fn) {

    const svg = mainDiv
      .append("svg")
        .attr("width", radius + 100)
        .attr("height", radius + 100)
      .append("g")
        .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")")

    // Read the data and then create the pie chart
    fn().then((odata) => {
      console.log(odata)

      const arcs = d3.pie().value(d => d.number)(odata.data)

      console.log(arcs)

      // map to data
      const u = svg.selectAll("path")
        .data(arcs)

      u.enter()
        .append('path')
        .merge(u)
        .transition()
        .duration(1000)
        .attr('d', d3.arc()
          .innerRadius(innerRadius)
          .outerRadius(radius)
        )
        .attr('fill', function(d){ return(d.data.colour) })
        .attr("stroke", "white")
        .style("stroke-width", "2px")
        .style("opacity", 1)

      u.exit()
        .remove()
    })
  }

/** @function getChartHeight
  * @description &lt;b>This function is exposed as a method on the API returned from the svgMap function&lt;/b>.
  * Return the blah.
  */
  function getChartHeight(){
      //todo
    return height
  }

  /**
   * @typedef {Object} api
   * @property {module:pie~getChartHeight} getChartHeight - Gets and returns the current height of the chart. 
   */
  return {
    getChartHeight: getChartHeight,
  }

}</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-pie.html">pie</a></li></ul><h3>Global</h3><ul><li><a href="global.html#dataAccessors">dataAccessors</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.4</a> on Fri Jan 22 2021 14:56:20 GMT+0000 (Greenwich Mean Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
